<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pixel App</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        textarea { width: 100%; height: 150px; }
        button { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Pixel App</h1>

    <label for="text">Text zum Generieren:</label><br>
    <textarea id="text"></textarea><br>
    <button onclick="generateText()">Generieren</button>
    <button onclick="exportArsip()">Export als .arsip</button>
    <input type="file" id="importFile" onchange="importArsip()">

    <h2>Output</h2>
    <textarea id="output" readonly></textarea>

    <script>
        const PALETTE = {{ palette|tojson }};
        
        async function generateText() {
            const text = document.getElementById("text").value;
            const response = await fetch("/generate", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ text })
            });
            const data = await response.json();
            document.getElementById("output").value = data.result;
        }

        async function exportArsip() {
            const content = { text: document.getElementById("text").value };
            const response = await fetch("/export", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(content)
            });
            const blob = await response.blob();
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "export.arsip";
            a.click();
            window.URL.revokeObjectURL(url);
        }

        async function importArsip() {
            const fileInput = document.getElementById("importFile");
            if (!fileInput.files.length) return;
            const formData = new FormData();
            formData.append("file", fileInput.files[0]);
            const response = await fetch("/import", { method: "POST", body: formData });
            const data = await response.json();
            document.getElementById("text").value = data.text || "";
            document.getElementById("output").value = "";
        }
    </script>
</body>
</html>
